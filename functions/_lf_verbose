# Ensure MFUNCDIR is set
[[ -v MFUNCDIR ]] ||
    MFUNCDIR="${HOME}/.functions" &&
    [[ -v ZDOTDIR ]] &&
        MFUNCDIR="${ZDOTDIR}/functions"

local functions=()

# get a list of functions managed by mfunc
local function_names=($MFUNCDIR/*)
function_names="${files[@]:t}" # strip the paths

autoload +X "${(z)function_names[@]}"

# Iterate over functions and append the body of each function to 'str'
for function_name in "${(z)function_names[@]}"; do
    functions+='\n'$(where "$function_name")'\n'
done
((${+commands[highlight]}))  &&
    highlight -S zsh -i <(print -ln "$functions") || {
    print -l $functions
    echo "Hint: install 'highlight' to enable syntax highlighting"
}
